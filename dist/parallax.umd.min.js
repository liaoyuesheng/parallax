!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Parallax=e()}(this,(function(){"use strict";var t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,n=(t||e||Function("return this")()).Symbol,s=Object.prototype,r=s.hasOwnProperty,o=s.toString,i=n?n.toStringTag:void 0;var c=Object.prototype.toString;var u=n?n.toStringTag:void 0;function l(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":u&&u in Object(t)?function(t){var e=r.call(t,i),n=t[i];try{t[i]=void 0;var s=!0}catch(t){}var c=o.call(t);return s&&(e?t[i]=n:delete t[i]),c}(t):function(t){return c.call(t)}(t)}function a(t){return null!=t&&"object"==typeof t}var h,p,f=(h=Object.getPrototypeOf,p=Object,function(t){return h(p(t))}),d=Function.prototype,m=Object.prototype,g=d.toString,b=m.hasOwnProperty,y=g.call(Object);function v(t){return a(t)&&1===t.nodeType&&!function(t){if(!a(t)||"[object Object]"!=l(t))return!1;var e=f(t);if(null===e)return!0;var n=b.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&g.call(n)==y}(t)}function _(t){const e=typeof t;if("function"!==e)throw new TypeError(`The "listener" argument must be of type Function. Received type ${e}`)}class j{constructor(){this._events={}}on(t,e,n=!1){_(e),this._events[t]||(this._events[t]=[]);const s=this._events[t];return n?s.unshift(e):s.push(e),this}off(t,e){const n=this._events[t];return n?(e?(_(e),this._events[t]=n.filter((t=>t!==e))):this._events[t]=[],this):this}once(t,e,n=!1){_(e);const s=(...n)=>{this.off(t,s),e.apply(this,n)};return this.on(t,s,n)}emit(t,...e){const n=this._events[t];return!(!n||!n.length)&&(n.forEach((t=>{t.apply(this,e)})),!0)}}class P{constructor(t){this.subs=[],this.data=t}addSub(t){this.subs.push(t),void 0!==this.data&&t.update(this.data)}notify(t){this.subs.forEach((e=>{e.update(t)}))}}function O(t){return t.match(/[$\d.]+/g).filter((t=>t)).map((t=>"$"===t[0]?t.substring(1):Number(t)))}class E{constructor(t){this.options=t,this.el=this.options.el,this.styleRenderer=function(t){const{startProgress:e,endProgress:n,startStyle:s,endStyle:r}=t,o=O(s),i=O(r);return function(t){const s=o.map(((s,r)=>{let o=i[r],c=!1;"string"==typeof s&&(s=Number(s),c=!0),"string"==typeof o&&(o=Number(o),c=!0);let u=(t-e)/(n-e)*(o-s)+s;const l=s<o?s:o,a=s<o?o:s;return u=Math.max(Math.min(u,a),l),c&&(u=Math.round(u),u<l&&(u=Math.ceil(l)),u>a&&(u=Math.floor(a))),u}));let c=0;return r.replace(/[$\d.]+/g,(()=>String(s[c++]).trim()))}}(t)}update(t){this.styleRenderer(t).split(";").forEach((t=>{if(!t)return;const e=t.split(":").map((t=>t.trim()));this.el.style[e[0]]=e[1]}))}}const S=["init","progress"];function x(t,e=document){if(v(t))return[t];if("string"==typeof t){const n=e.querySelectorAll(t);return Array.from(n)}return Array.from(t).filter((t=>v(t)))}const A={elements:".parallax-element",elementAttrPrefix:"parallax",customProgress:!1,startTop:0,endTop:-500,on:{}};return class{constructor(t){if(this._eventEmitter=new j,this.options=Object.assign({},A,t),!this.options.customProgress){const t=x(this.options.container,document)[0];if(!t)return this;this.container=t}this._initElements(),this._initEvents(),this.options.customProgress||(this._initScroll(),this.update(null,!0)),this._eventEmitter.emit("init",this)}_initElements(){this._dispatcher=new P;const t=x(this.options.elements,this.container);if(!t.length)return this;const e=this.options.elementAttrPrefix+"-start-progress",n=this.options.elementAttrPrefix+"-end-progress",s=this.options.elementAttrPrefix+"-start-style",r=this.options.elementAttrPrefix+"-end-style";t.forEach((t=>{const o=Number(t.getAttribute(e)||0),i=Number(t.getAttribute(n)||1),c=t.getAttribute(s),u=t.getAttribute(r);c&&u&&this._dispatcher.addSub(new E({el:t,startProgress:o,endProgress:i,startStyle:c,endStyle:u}))}))}_initScroll(t){(t?x(t)[0]:document).addEventListener("scroll",(()=>{this.update(null,!0)}))}_initEvents(){S.forEach((t=>{Object.prototype.hasOwnProperty.call(this.options.on,t)&&this._eventEmitter.on(t,this.options.on[t])}))}_updateProgress(){const t=this.container.getBoundingClientRect().top;return this.progress=function(t,e,n,s,r){let o=(t-e)/(n-e);return"number"==typeof s&&(o=Math.max(s,o)),"number"==typeof r&&(o=Math.min(r,o)),o}(t,this.options.startTop,this.options.endTop,0,1)}update(t,e=!1){const n=this.progress;if("number"==typeof t)t=Math.max(Math.min(t,1),0),this.progress=t;else{if(this.options.customProgress)return;this._updateProgress()}n!==this.progress&&(this._dispatcher.notify(this.progress),e&&this._eventEmitter.emit("progress",this,this.progress))}on(t,e){return function(t){S.indexOf(t)}(t),this._eventEmitter.on(t,e),this}}}));
//# sourceMappingURL=parallax.umd.min.js.map
